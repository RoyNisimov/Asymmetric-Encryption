from AsymmetricEncryptions.PublicPrivateKey.RSA import RSA
from AsymmetricEncryptions.PublicPrivateKey.ECC import ECKey, ECDH, EllipticCurveNISTP256
from AsymmetricEncryptions.Protocols import DiffieHellman
from time import time

def ECCDH():
    Alice_keys = ECKey.new(EllipticCurveNISTP256.get_curve())
    Bob_keys = ECKey.new(EllipticCurveNISTP256.get_curve())
    dh = ECDH(Alice_keys)
    Alice_shared = dh.Stage1(Bob_keys.public_key)
    Bob_shared = ECDH.Stage2(Bob_keys, Alice_keys.public_key)
    assert Alice_shared == Bob_shared
    return Alice_keys, Bob_keys, Alice_shared

def RSADH():
    AlicePriv, AlicePub = RSA.generate_key_pair(2048)
    BobPriv, BobPub = RSA.generate_key_pair(2048)
    dh = DiffieHellman.new(AlicePriv, 2048)
    A = dh.Stage1()
    gp = dh.get_gp()
    B, Bob_shared = DiffieHellman.Stage2(gp, BobPriv, A)
    Alice_shared = dh.Stage3(B)
    assert Alice_shared == Bob_shared
    return AlicePriv, BobPriv, Alice_shared

def func(f):
    st = time()
    out = f()
    et = time()
    total = et - st
    print(total)
    print("\n".join([str(i) for i in out]))

print("ECC with Diffie Hellman:")
func(ECCDH)
print("RSA with Diffie Hellman:")
func(RSADH)
"""
ECC with Diffie Hellman:
0.04388260841369629
self.private_key = 74246165448867103257264003691785079393698250376181151475644206669836459766264
self.public_key = (7691508838379772195069059044855136995846587251434542513247142234433060393418, 99568664988127760458770759894369792709319197931272480441784340185539272310013)
self.private_key = 78943910297869000600927181421687708963333711389300974401211967735631051800704
self.public_key = (60829255146198828929140677286514180344208361004500842248355095458529326253078, 55720194116126789937708833510035567669655294242112296418389588003755329618709)
(79422413050551254082948042372125048362697495249400164021649802426718148832782, 44948286054042608009744064515732105172829765036616671578562491257494320115711)
RSA with Diffie Hellman:
93.93977069854736

Private Key:

p = 21717081141952690003101576657210072469874411512593765271875571449349730966836675231078289442741132150152072787332730398102729761897052489455694925630397776108831530425702620666754165165443860714441096158092818114545541572377402982358369410986735507009213164511919678043968760388795260573462980796170474798303158384984637635374271826204384719304317658602126968204599169425433689279328317372220768904177185624222972115818282068544674343544954897037315630032180584819025344047137711910200831444024548193829557149962010971288164337922680083331732598732042846153815557087913645872033194892269785216454972293090736585846743
q = 25150345440333141285186695224553526601964172594125097788559137858364220559019301197981854617161990770182163921808390425718183383068892687709474300903960681499848405470264902724375801499744499545480676887955770629341403035693939033711250243639905922336410739161601417332772036712742569747232511313884853708107726393994219728690290915811075701964349343978419511685230818959968045301477418842770688422815103677051080337150616279153018012343608166012948338866450592297123201237518901216904871936070369576347130988040105100338310709228662778469787125389854334517742963141591934342530411468251467267840786261207432667958421
n = 546192092675854686037373186234757717884501306026459459267882242331376562364428748443353962411415170272295269138587553512954065227298310854607248871453596593973659916325777577940011939842510869472908587512804884160724312105847285518695989108970676804212515726958847756157801563285410394314159508196821030081923703864688836660694063874433433556830059796146095970453750272309164202463031385295126349786598246248854991997501842407726166431606317846742435644887003383898822514881888107546460851630955752834206455669483921796595642110507882499074019556223092144256723030284787598204674500242665974443910573219657964457169288958686996411174931562337140472322699110528476961591740297738678044831349608785257833478231321523311538726797356804986035205945069104715908908936804834539412081873998322205066781111050017975452643227397371101310571078391041055624088182479769863712299423531702205563774470336629403766869875502443012795451387310435866222658315050091729725955196907029304043658457993985856523848946498512232583216068251077814958884343661952474861521253112491414830601270521489663433958773406001066309988990963086382796131885850421815157178840223858381773059034911691437280977026115281726123113231885398895918277729110904203097402272803
tot_n = 546192092675854686037373186234757717884501306026459459267882242331376562364428748443353962411415170272295269138587553512954065227298310854607248871453596593973659916325777577940011939842510869472908587512804884160724312105847285518695989108970676804212515726958847756157801563285410394314159508196821030081923703864688836660694063874433433556830059796146095970453750272309164202463031385295126349786598246248854991997501842407726166431606317846742435644887003383898822514881888107546460851630955752834206455669483921796595642110507882499074019556223092144256723030284787598204674500242665974443910573219657964457169242091260414125343643274065258708723627271944370242728679863029370330879823752808828773334171418400391204490088215684162214292800103159538743739710270476081803401938102354681675651144384829615192721454351322512566684133782969713608018562825143222282953799628028684468397729539527865936549180010332957466944976425656887365294250487349714265533928240026723497178568163997471122114365692776017591758741258788513684831890693054127163828897223928351780337301622858486317810228121344453182883287582991465025955197712419699085552365176707038911257515187569540100305467595052220542898668279038374665793433352349904928148467640
e = 17070578680332174695816279667503631489308797810097538510624186126307462473384726543322542595722022992439208832766820214618674302270605548700874598294375305018500440808268591907849712274157238115032569237064876707742147045361960075892321599443224452061477551355899062390117395689285015916944574746945966715421345496693687353949538903932229886399049633398547534837513348615692721712177949064802187570957104013732846772993651056097870920906931930896990996634767250152694240476010890689129525974174209951043665408942186680617912704233989782375225856504909482113489577646172962361295744757962644341518982577023991838923717
d = 419734095607251776552338041043930836674763161600693027282745947784856487114501464535002731902465661049779732155960719761792255769263920329526486519657964118821890952070667267691859355353282613370504615522934996069788456924326938638385405420247567432854920824837374316607046944733319067481691090169711673008102398641875476379705686720983257668376562881414527073681898558027875180162031674476157756494225517663556185982172137177945823683760833807687570735024430913140793155746233110469800509342184873577791330576745172742317752730574064736810549672716447919985532741467459347864885802274176653439836907158775661258200279080138863177456650698389428220776377341517025834031096582157067080104875138784327039417691008665373443393460249102547538109060660948525775478026579444936128123681489084003158725389166037052047229698771485941251887008711749405464197893764489517979867271453111041449097075666627640652000709242002533885947249332398751859156684495011050028551848684786774960864766117233759673863129135519954025407629752164291696991717307261273492518114299781910726484122569181077487476046874174103345496504266869950157761225149027557084003692790308781820638295644537901855163632513203766270701570797367596030019497819393816142473346573


Public Key:

n = 546192092675854686037373186234757717884501306026459459267882242331376562364428748443353962411415170272295269138587553512954065227298310854607248871453596593973659916325777577940011939842510869472908587512804884160724312105847285518695989108970676804212515726958847756157801563285410394314159508196821030081923703864688836660694063874433433556830059796146095970453750272309164202463031385295126349786598246248854991997501842407726166431606317846742435644887003383898822514881888107546460851630955752834206455669483921796595642110507882499074019556223092144256723030284787598204674500242665974443910573219657964457169288958686996411174931562337140472322699110528476961591740297738678044831349608785257833478231321523311538726797356804986035205945069104715908908936804834539412081873998322205066781111050017975452643227397371101310571078391041055624088182479769863712299423531702205563774470336629403766869875502443012795451387310435866222658315050091729725955196907029304043658457993985856523848946498512232583216068251077814958884343661952474861521253112491414830601270521489663433958773406001066309988990963086382796131885850421815157178840223858381773059034911691437280977026115281726123113231885398895918277729110904203097402272803
e = 17070578680332174695816279667503631489308797810097538510624186126307462473384726543322542595722022992439208832766820214618674302270605548700874598294375305018500440808268591907849712274157238115032569237064876707742147045361960075892321599443224452061477551355899062390117395689285015916944574746945966715421345496693687353949538903932229886399049633398547534837513348615692721712177949064802187570957104013732846772993651056097870920906931930896990996634767250152694240476010890689129525974174209951043665408942186680617912704233989782375225856504909482113489577646172962361295744757962644341518982577023991838923717


Private Key:

p = 24042290830351383862428549955292561047269050124638844979723734729767135028718482087743452956557127445829784340315630389996185454725249322015307975114737867172028882593405382406737724279320104086973767923458853910810734159069344183061785589320620101771900423858964372987691312653876485693840437337571071898504356917435855645473667298369414200561352262428613102135062936186886249238210256039606617476486111842396606418188920379502583746555824182626560905419438734032988486586918967951540155328282900826905947886833933688929154210336161420421227369254180854489961270308750551606905218240060417141614630671394194060574071
q = 18513625675373330185789102601685845975305638823201225666468170254234535404172077435865870527035951831752369082808633947868012287360845057614703654071498712769130449649207120829654505268448082258423010006829269868273146403749302819254528770439090624606437180337408529286241414539665933739753524322766658157835042393843108865267301523513412773803583410586867204081720566295322162036888459975026707904035797459939768432459271226303487494116149098939666856572912594823701226439925376960609399507686318359801359686919056390195738529900398104146348228202923996883729715333004467412624562759990214884375227044394805946159871
n = 445109972811586162449728590302408960598232245445833002732931898668333155514176577338540159775349928136293541956214061623183456858846601089195369070977552259928132948561837411833986594352226210155582648793044571929053248001348057307300189268127598835067147315403274639725194216084351175377735503006262500135887874613416985371819140202600812985194207293992668169087836269548969894816965403608167452440013470867045374785854684439147386921589214527158267655094113981209288432546011427898520818017541877337544920890336015783888841767250380169999913054611806933379950738847773512771737460261180861771196745923639918226621557860808399831158826448894242575616518182901541961633916770256820945666502818585231916188713920644979448844494610488892529720489674627401674145582114026573915780452070553730083060829357162001880651655898708582436018312826959897718356098898035783941680135214516919840017648046985885771943776925590244330303374491038027711793721378196083587481732327236551850641549736793944158262836916617342903324655646844645711209077813099336345728734160779144167848094224099618281812641536501415029414615155301878043915413453559296259086693807546966121280369076793352070982309083750594711290383572189663291802149435112602884203304841
tot_n = 445109972811586162449728590302408960598232245445833002732931898668333155514176577338540159775349928136293541956214061623183456858846601089195369070977552259928132948561837411833986594352226210155582648793044571929053248001348057307300189268127598835067147315403274639725194216084351175377735503006262500135887874613416985371819140202600812985194207293992668169087836269548969894816965403608167452440013470867045374785854684439147386921589214527158267655094113981209288432546011427898520818017541877337544920890336015783888841767250380169999913054611806933379950738847773512771737460261180861771196745923639918226621515304891894106444778231241685597209495608212594121563270578351836943996069928025708306865230327565701866691071486224554665522747588533022044133952927789993974621119827941226846668599809393815535254877968420458656934432264141250716039784538276073215301797610320546937743715319792343352510182963929906600247035091726748747282980409374200760507367391563536370335332953291461949851561817901328269999275124935343374834227164907730539657493488805862601620332231748289425122928509657070117265060319332658857208105879806306179961801067310406596712793479336247219608618098108839692270853791189612659776159577396813884196570900
e = 27202980415655039684443290722524026476990112553270781710123321590570097137680859060710256961579145910017654086444113110129403401850057260139547574750971163799730045605444097870761699789259004230130622306212105414080818749294827090254873087723257757128095326871806395123523195319603559381325323075379005131488798784626393702717263082656234506448566769586645882958346410244649784226133672936176399342099581025449832107180127519853807092489364940363561708984475771537790723858565146528777950191260820441862615251741236284349277923768075407997660608827550246950556235162389105582402835456005587439374993982406022653995747
d = 76654137742760804411756362230495101973485300615827530943555726377349862019985502022079458756152160150019432143792105790686126520129459597672993627296745949611294602255306623323747346438232076811006964952169996802509905524495843960930475499216363593908958468240351467716944766298323013446380485748846374899839220841112345954511831325513286382787126732309706790195226478648989441173746506870090298307798793939837680637197406763731037735934602747979252918544269861173795347246320080375391897772296393516054420639394607728035420399423356057324812576227708903310930331005116359486554507242654508860798823797884182518475211655886774818013117087131285272859488755713166614359329463929075662872265363690971053002434709051052339436442379339764035121005075175134950679427784813511085025787385702645805962555050659896490787090896456365316172037644814401155233235269810099976856675049725977429799663010182880173121005301599159197556276027997112778212119104362447673667720180905852778888085391611225994102186362719381982605963056971399256959330842634260191481776478065770201917593178091646846851785528460333145998888146393789389204405149930944657470142278358001256764823605699553562633512748310537866116979460033108581399377705934086629108338183


Public Key:

n = 445109972811586162449728590302408960598232245445833002732931898668333155514176577338540159775349928136293541956214061623183456858846601089195369070977552259928132948561837411833986594352226210155582648793044571929053248001348057307300189268127598835067147315403274639725194216084351175377735503006262500135887874613416985371819140202600812985194207293992668169087836269548969894816965403608167452440013470867045374785854684439147386921589214527158267655094113981209288432546011427898520818017541877337544920890336015783888841767250380169999913054611806933379950738847773512771737460261180861771196745923639918226621557860808399831158826448894242575616518182901541961633916770256820945666502818585231916188713920644979448844494610488892529720489674627401674145582114026573915780452070553730083060829357162001880651655898708582436018312826959897718356098898035783941680135214516919840017648046985885771943776925590244330303374491038027711793721378196083587481732327236551850641549736793944158262836916617342903324655646844645711209077813099336345728734160779144167848094224099618281812641536501415029414615155301878043915413453559296259086693807546966121280369076793352070982309083750594711290383572189663291802149435112602884203304841
e = 27202980415655039684443290722524026476990112553270781710123321590570097137680859060710256961579145910017654086444113110129403401850057260139547574750971163799730045605444097870761699789259004230130622306212105414080818749294827090254873087723257757128095326871806395123523195319603559381325323075379005131488798784626393702717263082656234506448566769586645882958346410244649784226133672936176399342099581025449832107180127519853807092489364940363561708984475771537790723858565146528777950191260820441862615251741236284349277923768075407997660608827550246950556235162389105582402835456005587439374993982406022653995747

b"\xab\xea\n\x01\xef\xee\x83\xce\xfb\x8ft\xa7h\x8a\x9d\xe1!\xa6\xc6\x90\xac\xf1\xb05\xcf\x0bK\xc2\x07\x06\xa1Ie\xcf\x8a\xc7\xa1\x98\xb3\xcc?\xcd\xe7\xae\x98kWeuK\xcf\x8c\xcd\x0fbZ\x1d@\x07\xb9\xd5\xc8\xbfZ\xf3\xe68\xd3\xa6c)\xc1\x14\xa1\xc5j\xec\xd0V.\xc5\xf8\x1a)\xf1F\x0c35\xe1\xa7\x93?Dv\xea\xdb\x0c\xdbB\x1b\x0f\xccI\xf2\xf99.\xae0{\x86\xdd\xcb\x80\xdb\xc9$\xbcJ\xfe\x8d ]G\xa7]\xce\xd3\x189r\xe2\xe0T\x07V\xbe\xc4\x03\x18\xe8JV\xe6\xed\xd0\xf5j\xbeS\xe1\x1e\xfe\xfa\x8b\xa6\r\xcf\xd2\x1dW8\x98\t\xb5\xa3\xec\xa3'\x9dc\x1ef@\x93\x11\x9e~u\xe2\x839\xd9\xe9*\x82\xf80\xf5\x81\xe4\x0ffE/\x10\xcd\xf9\xe1\xf4\x7f\xc3-(#\x14F\xd9QH8\xf2\xcc\xf2xAM\xd1\xd0\x0b\x8a\xfal\xfa\x807\xbd[K\xf1,d\x03\xc2?\xc1cg9\xe3\xa9g\x1fy\x87\x9f\xfb\xf7\x92?\x1e\x88\x19\xd2]"
"""